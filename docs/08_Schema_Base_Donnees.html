<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08 - Sch√©ma de Base de Donn√©es - FarmShop</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 40px;
            background-color: #ffffff;
            color: #333;
            max-width: 210mm;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin: 0 0 20px 0;
        }

        .institution {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 20px;
        }

        .student-info {
            font-size: 16px;
            font-weight: 500;
        }

        h2 {
            color: #2c3e50;
            font-size: 24px;
            font-weight: 600;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        h3 {
            color: #34495e;
            font-size: 20px;
            font-weight: 500;
            margin: 30px 0 15px 0;
        }

        .description {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            font-size: 16px;
            margin: 30px 0;
        }

        .relation-box {
            margin: 15px 0;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid;
        }

        .relation-box.primary {
            background-color: #e3f2fd;
            border-left-color: #2196f3;
        }

        .relation-box.interactions {
            background-color: #fff8e1;
            border-left-color: #ff9800;
        }

        .relation-box.products {
            background-color: #e8f5e8;
            border-left-color: #4caf50;
        }

        .relation-box.cart {
            background-color: #fce4ec;
            border-left-color: #e91e63;
        }

        .relation-box.orders {
            background-color: #f3e5f5;
            border-left-color: #9c27b0;
        }

        .relation-box.locations {
            background-color: #e0f2f1;
            border-left-color: #009688;
        }

        .relation-box.conversion {
            background-color: #e1f5fe;
            border-left-color: #00bcd4;
        }

        .relation-box.communication {
            background-color: #f9fbe7;
            border-left-color: #8bc34a;
        }

        .relation-box.content {
            background-color: #fff3e0;
            border-left-color: #ff5722;
        }

        .relation-box.security {
            background-color: #ffebee;
            border-left-color: #f44336;
        }

        .relation-box.permissions {
            background-color: #fafafa;
            border-left-color: #607d8b;
        }

        .table-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .table-section h4 {
            color: #495057;
            font-size: 18px;
            font-weight: 600;
            margin: 0 0 15px 0;
        }

        .table-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }

        .table-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #007bff;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .notes-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 40px 0;
        }

        .notes-section h3 {
            color: white;
            margin-top: 0;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }

        li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        li:before {
            content: "‚ñ∂";
            position: absolute;
            left: 0;
            color: #3498db;
            font-weight: bold;
        }

        .strong-relation {
            font-weight: 600;
            color: #2c3e50;
        }

        .cardinality {
            font-weight: 700;
            color: #e74c3c;
            background-color: #fff5f5;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-size: 14px;
        }

        @media print {
            body { 
                margin: 20px;
                padding: 0;
            }
            .header, .notes-section, .footer {
                background: #f8f9fa !important;
                color: #333 !important;
                border: 2px solid #dee2e6;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Livrable 08 - Sch√©ma de Base de Donn√©es</h1>
        <div class="institution">
            <strong>Communaut√© Fran√ßaise de Belgique</strong><br>
            <strong>Institut des Carri√®res Commerciales</strong><br>
            <strong>Ville de Bruxelles</strong><br>
            Rue de la Fontaine 4<br>
            1000 BRUXELLES
        </div>
        <hr style="border: 1px solid rgba(255,255,255,0.3); margin: 20px 0;">
        <div style="font-style: italic; margin: 15px 0;">
            √âpreuve int√©gr√©e r√©alis√©e en vue de l'obtention du titre de<br>
            ¬´ Bachelier en Informatique de gestion, orientation d√©veloppement d'applications ¬ª
        </div>
        <div class="student-info">
            <strong>MEFTAH Soufiane</strong><br>
            2024 ‚Äì 2025
        </div>
    </div>

    <div class="description">
        <h2 style="color: white; border: none; margin-top: 0;">üéØ Description du Sch√©ma</h2>
        <strong>FarmShop</strong> est une plateforme e-commerce innovante sp√©cialis√©e dans la <strong>vente et la location d'√©quipements agricoles</strong>. Le syst√®me g√®re un double flux m√©tier : les <strong>achats traditionnels</strong> et un <strong>syst√®me de location unique</strong> avec gestion sophistiqu√©e des cautions, p√©nalit√©s et contraintes temporelles.
    </div>

    <h2>üë• Relations Utilisateurs</h2>
    
    <h3>üîó Relations Principales</h3>
    <div class="relation-box primary">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut cr√©er plusieurs produits</span> - Un produit appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut passer plusieurs commandes</span> - Une commande appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs commandes de location</span> - Une commande de location appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs locations actives</span> - Une location appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur poss√®de un panier d'achat</span> - Un panier appartient √† un utilisateur <span class="cardinality">[1-1]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs paniers de location</span> - Un panier de location appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>ü§ù Relations Interactions</h3>
    <div class="relation-box interactions">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut envoyer plusieurs contacts</span> - Un contact appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut aimer plusieurs produits</span> - Un produit peut √™tre aim√© par plusieurs utilisateurs <span class="cardinality">[*-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs produits en wishlist</span> - Un produit peut √™tre dans plusieurs wishlists <span class="cardinality">[*-*]</span></li>
        </ul>
    </div>

    <h2>üì¶ Relations Produits & Cat√©gories</h2>
    
    <h3>üèóÔ∏è Structure des Produits</h3>
    <div class="relation-box products">
        <ul>
            <li><span class="strong-relation">Une cat√©gorie contient plusieurs produits</span> - Un produit appartient √† une cat√©gorie <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut avoir plusieurs images</span> - Une image appartient √† un produit <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut avoir plusieurs offres sp√©ciales</span> - Une offre sp√©ciale appartient √† un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üîÑ Interactions Utilisateurs-Produits</h3>
    <div class="relation-box interactions">
        <ul>
            <li><span class="strong-relation">Un produit peut √™tre aim√© par plusieurs utilisateurs</span> - Un utilisateur peut aimer plusieurs produits <span class="cardinality">[*-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre dans plusieurs wishlists</span> - Un utilisateur peut avoir plusieurs produits en wishlist <span class="cardinality">[*-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre ajout√© dans plusieurs paniers</span> - Un article de panier r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre lou√© dans plusieurs paniers de location</span> - Un article de location r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h2>üõí Relations Panier & Articles</h2>
    
    <h3>üõçÔ∏è Panier d'Achat Classique</h3>
    <div class="relation-box cart">
        <ul>
            <li><span class="strong-relation">Un panier contient plusieurs articles</span> - Un article de panier appartient √† un panier <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs articles dans son panier</span> - Un article de panier appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre dans plusieurs paniers</span> - Un article de panier r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üöú Panier de Location</h3>
    <div class="relation-box locations">
        <ul>
            <li><span class="strong-relation">Un panier de location contient plusieurs articles de location</span> - Un article de location appartient √† un panier de location <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre dans plusieurs paniers de location</span> - Un article de location r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h2>üìã Relations Commandes & Articles</h2>
    
    <h3>üí≥ Commandes d'Achat</h3>
    <div class="relation-box orders">
        <ul>
            <li><span class="strong-relation">Une commande contient plusieurs articles</span> - Un article de commande appartient √† une commande <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre command√© plusieurs fois</span> - Un article de commande r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un article de commande peut avoir un retour</span> - Un retour appartient √† un article de commande <span class="cardinality">[1-1]</span></li>
            <li><span class="strong-relation">Une commande peut avoir plusieurs retours</span> - Un retour appartient √† une commande <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üìÖ Commandes de Location</h3>
    <div class="relation-box locations">
        <ul>
            <li><span class="strong-relation">Une commande de location contient plusieurs articles</span> - Un article de location appartient √† une commande de location <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre lou√© plusieurs fois</span> - Un article de location r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h2>üè† Relations Locations & Gestion</h2>
    
    <h3>üîÑ Gestion des Locations Actives</h3>
    <div class="relation-box locations">
        <ul>
            <li><span class="strong-relation">Une location contient plusieurs articles</span> - Un article de location appartient √† une location <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un produit peut √™tre lou√© dans plusieurs locations</span> - Un article de location r√©f√©rence un produit <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>‚ö†Ô∏è Syst√®me de P√©nalit√©s</h3>
    <div class="relation-box security">
        <ul>
            <li><span class="strong-relation">Un article de location peut g√©n√©rer plusieurs p√©nalit√©s</span> - Une p√©nalit√© appartient √† un article de location <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Une location peut avoir plusieurs p√©nalit√©s</span> - Une p√©nalit√© appartient √† une location <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h2>üîÑ Relations de Conversion (Processus M√©tier)</h2>
    
    <h3>üîÅ Transformation des Paniers en Commandes</h3>
    <div class="relation-box conversion">
        <ul>
            <li><span class="strong-relation">Un panier de location se convertit en commande de location</span> - Une commande de location provient d'un panier de location <span class="cardinality">[1-1]</span></li>
            <li><span class="strong-relation">Un article de panier de location se convertit en article de commande de location</span> - Un article de commande de location provient d'un article de panier <span class="cardinality">[1-1]</span></li>
        </ul>
    </div>

    <h3>üéØ Transformation des Commandes en Locations</h3>
    <div class="relation-box conversion">
        <ul>
            <li><span class="strong-relation">Une commande de location devient une location</span> - Une location provient d'une commande de location <span class="cardinality">[1-1]</span></li>
        </ul>
    </div>

    <h2>üí¨ Relations Communication</h2>
    
    <h3>üìß Messages et Support</h3>
    <div class="relation-box communication">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut envoyer plusieurs messages admin</span> - Un message admin appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un message admin peut avoir plusieurs r√©ponses</span> - Une r√©ponse appartient √† un message admin <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut √©crire plusieurs r√©ponses</span> - Une r√©ponse appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üìû Gestion des Contacts</h3>
    <div class="relation-box communication">
        <ul>
            <li><span class="strong-relation">Un admin peut √™tre assign√© √† plusieurs contacts</span> - Un contact peut √™tre assign√© √† un admin <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h2>üìù Relations Contenu</h2>
    
    <h3>üì∞ Gestion du Blog (Administration)</h3>
    <div class="relation-box content">
        <ul>
            <li><span class="strong-relation">Un admin peut cr√©er plusieurs articles de blog</span> - Un article de blog appartient √† un admin <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un admin peut cr√©er plusieurs newsletters</span> - Une newsletter appartient √† un admin <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üí≠ Interactions Utilisateurs avec le Contenu</h3>
    <div class="relation-box content">
        <ul>
            <li><span class="strong-relation">Un blog peut recevoir plusieurs commentaires</span> - Un commentaire appartient √† un blog <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut √©crire plusieurs commentaires</span> - Un commentaire appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un commentaire peut avoir plusieurs r√©ponses</span> - Un commentaire peut r√©pondre √† un autre commentaire <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üõ°Ô∏è Syst√®me de Mod√©ration</h3>
    <div class="relation-box security">
        <ul>
            <li><span class="strong-relation">Un commentaire peut √™tre signal√© plusieurs fois</span> - Un signalement appartient √† un commentaire <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut faire plusieurs signalements</span> - Un signalement appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un admin peut traiter plusieurs signalements</span> - Un signalement peut √™tre trait√© par un admin <span class="cardinality">[1-*]</span></li>
        </ul>
    </div>

    <h3>üì® Newsletter</h3>
    <div class="relation-box content">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut avoir un abonnement newsletter</span> - Un abonnement newsletter appartient √† un utilisateur <span class="cardinality">[1-1]</span></li>
        </ul>
    </div>

    <h2>üîí Relations Confidentialit√©</h2>
    
    <h3>üç™ Gestion des Cookies et Consentements</h3>
    <div class="relation-box security">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut donner plusieurs consentements de cookies</span> - Un consentement appartient √† un utilisateur <span class="cardinality">[1-*]</span></li>
            <li><span class="strong-relation">Un cookie peut √™tre consenti par plusieurs utilisateurs</span> - Un consentement peut concerner plusieurs cookies <span class="cardinality">[*-*]</span></li>
        </ul>
    </div>

    <h2>üîê Relations Permissions (Spatie Laravel-Permission)</h2>
    
    <h3>üë§ Syst√®me de R√¥les et Permissions</h3>
    <div class="relation-box permissions">
        <ul>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs r√¥les</span> - Un r√¥le peut √™tre attribu√© √† plusieurs utilisateurs <span class="cardinality">[*-*]</span></li>
            <li><span class="strong-relation">Un utilisateur peut avoir plusieurs permissions</span> - Une permission peut √™tre attribu√©e √† plusieurs utilisateurs <span class="cardinality">[*-*]</span></li>
            <li><span class="strong-relation">Un r√¥le peut avoir plusieurs permissions</span> - Une permission peut appartenir √† plusieurs r√¥les <span class="cardinality">[*-*]</span></li>
        </ul>
    </div>

    <h2>üóÉÔ∏è Tables Principales Identifi√©es</h2>

    <div class="table-section">
        <h4>üë• Tables Utilisateurs et Authentification</h4>
        <div class="table-list">
            <div class="table-item">users</div>
            <div class="table-item">roles</div>
            <div class="table-item">permissions</div>
            <div class="table-item">model_has_roles</div>
            <div class="table-item">model_has_permissions</div>
            <div class="table-item">role_has_permissions</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üì¶ Tables Produits et Catalogue</h4>
        <div class="table-list">
            <div class="table-item">categories</div>
            <div class="table-item">products</div>
            <div class="table-item">product_images</div>
            <div class="table-item">special_offers</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üõí Tables Panier et Navigation</h4>
        <div class="table-list">
            <div class="table-item">carts</div>
            <div class="table-item">cart_items</div>
            <div class="table-item">cart_locations</div>
            <div class="table-item">cart_item_locations</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üìã Tables Commandes</h4>
        <div class="table-list">
            <div class="table-item">orders</div>
            <div class="table-item">order_items</div>
            <div class="table-item">order_returns</div>
            <div class="table-item">order_locations</div>
            <div class="table-item">order_item_locations</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üè† Tables Locations</h4>
        <div class="table-list">
            <div class="table-item">rentals</div>
            <div class="table-item">rental_items</div>
            <div class="table-item">rental_penalties</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üí¨ Tables Communication</h4>
        <div class="table-list">
            <div class="table-item">contacts</div>
            <div class="table-item">admin_messages</div>
            <div class="table-item">admin_message_replies</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üìù Tables Contenu</h4>
        <div class="table-list">
            <div class="table-item">blogs</div>
            <div class="table-item">blog_comments</div>
            <div class="table-item">blog_comment_reports</div>
            <div class="table-item">newsletters</div>
            <div class="table-item">newsletter_subscriptions</div>
        </div>
    </div>

    <div class="table-section">
        <h4>ü§ù Tables Interactions</h4>
        <div class="table-list">
            <div class="table-item">product_likes</div>
            <div class="table-item">wishlists</div>
        </div>
    </div>

    <div class="table-section">
        <h4>üîí Tables Confidentialit√©</h4>
        <div class="table-list">
            <div class="table-item">cookies</div>
            <div class="table-item">cookie_consents</div>
        </div>
    </div>

    <div class="notes-section">
        <h2 style="color: white; border: none;">‚öôÔ∏è Notes Techniques</h2>
        
        <h3>üìã Conventions de Nommage</h3>
        <ul>
            <li><strong>Cl√©s primaires :</strong> id (BIGINT UNSIGNED)</li>
            <li><strong>Cl√©s √©trang√®res :</strong> {table}_id (BIGINT UNSIGNED)</li>
            <li><strong>Timestamps :</strong> created_at, updated_at</li>
            <li><strong>Soft deletes :</strong> deleted_at (sur certaines tables sensibles)</li>
        </ul>

        <h3>üöÄ Index et Contraintes</h3>
        <ul>
            <li>Contraintes de cl√©s √©trang√®res activ√©es</li>
            <li>Index sur les cl√©s √©trang√®res pour optimiser les performances</li>
            <li>Index composites sur les relations many-to-many</li>
            <li>Contraintes d'unicit√© sur les couples (user_id, product_id) pour likes et wishlists</li>
        </ul>

        <h3>üéØ Particularit√©s M√©tier</h3>
        <ul>
            <li><strong>Syst√®me dual</strong> achat/location avec des flux s√©par√©s</li>
            <li><strong>Gestion des cautions</strong> pour les locations</li>
            <li><strong>Syst√®me de p√©nalit√©s</strong> automatis√© (10‚Ç¨/jour de retard)</li>
            <li><strong>Conversion automatique</strong> panier ‚Üí commande ‚Üí location</li>
            <li><strong>Gestion des retours</strong> pour les achats</li>
            <li><strong>Syst√®me de notifications</strong> int√©gr√©es</li>
        </ul>
    </div>

    <div class="footer">
        <strong>üìä Document g√©n√©r√© le 15 juillet 2025</strong><br>
        üéì <strong>MEFTAH Soufiane</strong> - Bachelier en Informatique de gestion<br>
        üèõÔ∏è <strong>Institut des Carri√®res Commerciales - Bruxelles</strong>
    </div>

</body>
</html>
